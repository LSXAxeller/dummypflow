<shadui:Window
    x:Class="ProseFlow.UI.Views.Windows.ResultWindow"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:md="https://github.com/whistyun/Markdown.Avalonia"
    xmlns:shadui="clr-namespace:ShadUI;assembly=ShadUI"
    xmlns:vm="using:ProseFlow.UI.ViewModels.Windows"
    x:DataType="vm:ResultViewModel"

    Title="{Binding ActionName}"
    Icon="/Assets/avalonia-logo.ico"
    Width="600" Height="500" MinWidth="450" MinHeight="350"
    WindowStartupLocation="CenterScreen"
    SaveWindowState="True">

    <DockPanel LastChildFill="True">
        <!-- Footer with action buttons -->
        <Border
            DockPanel.Dock="Bottom"
            Padding="16"
            BorderBrush="{DynamicResource BorderColor}"
            BorderThickness="0,1,0,0">
            <StackPanel
                HorizontalAlignment="Right"
                Orientation="Horizontal"
                Spacing="8">
                <Button
                    Classes="Outline"
                    Command="{Binding CopyCommand}">
                    <shadui:ButtonAssist.Icon>
                        <TextBlock Classes="LucideIcon" Text="" />
                    </shadui:ButtonAssist.Icon>
                    Copy to Clipboard
                </Button>
                <Button
                    Classes="Primary"
                    Click="CloseWindow"
                    IsDefault="True">
                    <shadui:ButtonAssist.Icon>
                        <TextBlock Classes="LucideIcon" Text="" />
                    </shadui:ButtonAssist.Icon>
                    Close
                </Button>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Padding="16">
            <StackPanel Spacing="16">
                <!-- Main Result Content -->
                <StackPanel>
                    <TextBlock Classes="h4" Text="Result" Margin="0,0,0,8" />
                    <md:MarkdownScrollViewer
                        Markdown="{Binding MainContent}" />
                </StackPanel>

                <!-- Explanation Section -->
                <shadui:Card
                    Padding="0"
                    IsVisible="{Binding IsExplanationVisible}">
                    <Expander
                        HorizontalAlignment="Stretch"
                        Padding="16,8">
                        <Expander.Header>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Classes="LucideIcon" Text="&#xE063;" />
                                <TextBlock FontWeight="Medium" Text="Show Explanation" />
                            </StackPanel>
                        </Expander.Header>
                        <md:MarkdownScrollViewer
                            Margin="0,8,0,0"
                            Markdown="{Binding ExplanationContent}"
                            MaxHeight="200" />
                    </Expander>
                </shadui:Card>
            </StackPanel>
        </ScrollViewer>
    </DockPanel>
</shadui:Window>